#!/usr/bin/env bash
#
# sysinfo - display Linux system information

get_cpu_info () {
    local cpu_count="$(grep -c processor /proc/cpuinfo)"
    local cpu_model="$(grep -m1 -i 'model name' /proc/cpuinfo | awk -F ': ' '{print $2}')"
    if [ -z "${cpu_model}" ]; then
        local cpu_model="$(grep -m1 -i 'model' /proc/cpuinfo | awk -F ': ' '{print $2}')"
    fi
    echo -e "${cpu_count} x ${cpu_model}"
}

GRAY="\033[1;37m"
PURPLE="\033[1;35m"
GREEN="\033[1;32m"

HOST="$(hostname --long)"
IP="$(hostname --all-ip-addresses | awk '{print $1}')"
UPTIME="$(uptime -p | cut -d ' ' -f 2-)"
DISTRIBUTION="$(lsb_release -s -d)"
KERNEL="$(uname -r)"
PLATFORM="$(uname -m)"
CPUCOUNT="$(grep -c processor /proc/cpuinfo)"
CPU="$(get_cpu_info)"
PROCS="$(ps -e --no-header | grep -E -v 'ps$|grep$|wc$' | wc -l)"
MEM="$(free -m \
    | awk '/^Mem:/{printf "%.2fG Free of %.2fG Total", $4/1024, $2/1024}')"
DISK="$(df --human-readable --local --si --sync / \
    | grep -v 'Filesystem' \
    | awk '{printf "%s Used of %s Total (%s)", $3, $2, $5}')"

echo -e "
${GRAY}        Host ${PURPLE}= ${GREEN}${HOST}
${GRAY}          IP ${PURPLE}= ${GREEN}${IP}
${GRAY}      Uptime ${PURPLE}= ${GREEN}${UPTIME}
${GRAY}      Distro ${PURPLE}= ${GREEN}${DISTRIBUTION}
${GRAY}      Kernel ${PURPLE}= ${GREEN}${KERNEL}
${GRAY}    Platform ${PURPLE}= ${GREEN}${PLATFORM}
${GRAY}         CPU ${PURPLE}= ${GREEN}${CPU}
${GRAY}      Memory ${PURPLE}= ${GREEN}${MEM}
${GRAY}        Disk ${PURPLE}= ${GREEN}${DISK}
${GRAY}       Procs ${PURPLE}= ${GREEN}${PROCS}
"
